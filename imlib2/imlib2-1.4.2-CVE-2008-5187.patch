Submitted By: Agathoklis Hatzimanikas (ag at linuxfromscratch dot org)
Date: 2008-12-27
Initial Package Version: 1.4.2
Origin: Upstream
Upstream Status: Applied
Description: Fixes CVE-2008-5187
	http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5187
	http://trac.enlightenment.org/e/ticket/136

diff -Naur imlib2-1.4.2.orig/src/modules/loaders/loader_xpm.c imlib2-1.4.2/src/modules/loaders/loader_xpm.c
--- imlib2-1.4.2.orig/src/modules/loaders/loader_xpm.c	2008-10-21 05:32:51.000000000 +0300
+++ imlib2-1.4.2/src/modules/loaders/loader_xpm.c	2008-12-27 10:56:40.469652022 +0200
@@ -253,8 +253,8 @@
                                  return 0;
                               }
                             ptr = im->data;
-                            end = ptr + (sizeof(DATA32) * w * h);
                             pixels = w * h;
+                            end = ptr + (pixels);
                          }
                        else
                          {
